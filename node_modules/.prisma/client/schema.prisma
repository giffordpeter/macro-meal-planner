// This is your Prisma schema file
datasource db {
  provider = "postgresql"
  url      = env("DATABASE_URL")
}

generator client {
  provider = "prisma-client-js"
}

model User {
  id        String     @id @default(cuid())
  name      String?
  email     String     @unique
  password  String?
  image     String?
  createdAt DateTime   @default(now())
  updatedAt DateTime   @updatedAt
  profile   Profile?
  mealPlans MealPlan[]
}

model Profile {
  id                  String   @id @default(cuid())
  userId              String   @unique
  user                User     @relation(fields: [userId], references: [id], onDelete: Cascade)
  height              Float?
  weight              Float?
  age                 Int?
  gender              String?
  activityLevel       String?
  goal                String? // e.g., "weight_loss", "muscle_gain", "maintenance"
  dietaryRestrictions String[]
  calorieGoal         Int?
  proteinGoal         Int?
  carbGoal            Int?
  fatGoal             Int?
  createdAt           DateTime @default(now())
  updatedAt           DateTime @updatedAt
}

model MealPlan {
  id            String   @id @default(cuid())
  userId        String
  user          User     @relation(fields: [userId], references: [id], onDelete: Cascade)
  date          DateTime
  meals         Meal[]
  totalCalories Int
  totalProtein  Int
  totalCarbs    Int
  totalFat      Int
  createdAt     DateTime @default(now())
  updatedAt     DateTime @updatedAt
}

model Meal {
  id         String   @id @default(cuid())
  mealPlanId String
  mealPlan   MealPlan @relation(fields: [mealPlanId], references: [id], onDelete: Cascade)
  name       String
  type       String // e.g., "breakfast", "lunch", "dinner", "snack"
  recipes    Recipe[]
  calories   Int
  protein    Int
  carbs      Int
  fat        Int
  createdAt  DateTime @default(now())
  updatedAt  DateTime @updatedAt
}

model Recipe {
  id           String       @id @default(cuid())
  name         String
  description  String?
  instructions String[]
  ingredients  Ingredient[]
  meals        Meal[]
  calories     Int
  protein      Int
  carbs        Int
  fat          Int
  prepTime     Int? // in minutes
  cookTime     Int? // in minutes
  servings     Int?
  cuisine      String?
  createdAt    DateTime     @default(now())
  updatedAt    DateTime     @updatedAt
}

model Ingredient {
  id        String   @id @default(cuid())
  name      String
  amount    Float
  unit      String
  calories  Int
  protein   Int
  carbs     Int
  fat       Int
  recipes   Recipe[]
  createdAt DateTime @default(now())
  updatedAt DateTime @updatedAt
}
